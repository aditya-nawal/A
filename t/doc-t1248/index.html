<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document doc-t1248</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .metadata {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">Modelling indoor airborne transmission combining architectural design and people movement using the VIRIS simulator and web app Download PDF Download PDF Subjects Diseases Engineering Mathematics and computing Physics Abstract A Viral Infection Risk Indoor Simulator (VIRIS) has been developed to quickly assess and compare mitigations for airborne disease spread. This agent-based simulator combines people movement in an indoor space, viral transmission modelling and detailed architectural design, and it is powered by topologicpy, an open-source Python library. VIRIS generates very fast predictions of the viral concentration and the spatiotemporal infection risk for individuals as they move through a given space. The simulator is validated with data from a courtroom superspreader event. A sensitivity study for unknown parameter values is also performed. We compare several non-pharmaceutical interventions (NPIs) issued in UK government guidance, for two indoor settings: a care home and a supermarket. Additionally, we have developed the user-friendly VIRIS web app that allows quick exploration of diverse scenarios of interest and visualisation, allowing policymakers, architects and space managers to easily design or assess infection risk in an indoor space. Similar content being viewed by others Evaluating efficacy of indoor non-pharmaceutical interventions against COVID-19 outbreaks with a coupled spatial-SIR agent-based simulation framework Article Open access 13 April 2022 Predicting and preventing COVID-19 outbreaks in indoor environments: an agent-based modeling study Article Open access 27 September 2022 A comprehensive modelling approach to estimate the transmissibility of coronavirus and its variants from infected subjects in indoor environments Article Open access 19 August 2022 Introduction In the COVID-19 pandemic, more than 700 million were infected and more than 7 million died 1 . One reason for the rapid and widespread transmission is that, unlike many other infectious diseases, it can be transmitted via aerosols 2 . The aerosols can remain suspended in the air for hours and can travel long distances 3 , thus, increasing infection risk. During the pandemic, policymakers and space managers had to make fast decisions to mitigate transmission, often without available scientific inputs. Mathematical modellers, including some of the authors here, collaborated closely with governments and developed models of transmission to inform policy, for various indoor scenarios including educational settings 4 , 5 , restaurants 4 , 6 , 7 , supermarkets 8 , 9 , 10 , a choral practice 11 , a courtroom 4 , 12 and a train carriage 13 . These models quantify the infection risk in indoor spaces for different non-pharmaceutical interventions (NPIs). However, people movement was considered in very few models 7 , 8 , 9 , 14 , 15 , 16 , limiting the accuracy of simulations, especially in settings where people are actively moving around (e.g. supermarkets). In addition, most models either neglect the physics of the spread of infectious aerosols 8 , 9 , 11 , 12 , 15 , 16 , or use computational fluid dynamics simulations 6 , 10 , 14 , making them too computationally intensive for fast policymaking. Here, building on research Kaouri and Woolley used to inform policy during the pandemic 4 , 5 , we present VIRIS, a new simulator and a web app that incorporates both people movement and aerosol physics in geometrically complex, architecturally defined spaces, providing solutions with great speed. Following Lau et al. 4 , we use a reaction-diffusion equation to simulate the spatiotemporal distribution of infectious aerosols and determine the spatiotemporal infection risk extending the Wells-Riley ansatz 17 . People movement is modelled using an agent-based approach based on a navigation graph, embedded into topologicpy 18 , 19 for the purpose of this work. Topologicpy is an advanced spatial modelling and analysis software (Python) library for architecture, engineering, and construction; further details on topologicpy and the navigation graph can be found in a companion paper 20 . In “ Mathematical model and assumptions ”, we describe the modelling framework underpinning VIRIS and discuss parameter values. In “ Results ”, we demonstrate how VIRIS can be used to model a series of diverse NPIs, in a care home and in a supermarket. In addition, in “ Web app ”, we introduce a user-friendly web app underpinned by VIRIS. The results are discussed in “ Discussion ”. Mathematical model and assumptions We present VIRIS, an agent-based modelling framework and simulator that combines airborne viral transmission, people movement and detailed architectural design. Below, we present the model, assumptions, parameter values, and its numerical implementation. Assumptions An infectious individual is assumed to be a moving point source of infectious aerosols. We assume that the aerosols are emitted with zero velocity, a good assumption, since we do not consider coughing or sneezing 21 . In reality, particle size varies, following a probability density function 22 , 23 ; for simplicity, and similarly to other works 4 , 6 , 7 , we assume that the aerosols can be modelled using a single representative size, with a constant gravitational settling rate 24 , \(\gamma\) . Furthermore, we are justified to neglect large droplets, since evaporation happens very quickly (seconds to minutes) 25 , 26 . Experimental studies 27 , 28 show that the virus deactivation rate depends on a variety of factors including relative humidity, temperature and sunlight. From data 27 , 28 , we assume a constant virus deactivation rate, \(\beta\) , as reported by van Doramalen et al. 29 ; thus is an accurate assumption for most indoor settings (temperature around 20 \(^{\circ }\) C and relative humidity below 60%). The infectious aerosols are not well-mixed in an indoor space 30 , 31 ; they assume a spatiotemporal distribution. Here, we focus on single storey buildings, but our methodology can be extended to multistorey buildings. The indoor space, which includes furniture, is bounded by walls or doors. Furthermore, without loss of generality, we assume perfect reflection of aerosols off walls 4 . Furniture that is higher than a person’s height are also modelled as walls; otherwise we assume that furniture has no effect on viral transmission, since the airborne particles can flow over them. We assume that the infectious aerosols are well-mixed along the room height; this allows to reduce the three-dimensional (3D) model to a two-dimensional (2D) model of viral transmission. Poor ventilation is found in many diverse indoor settings (for example, schools 32 , care homes 33 , supermarkets 34 , courtrooms 12 , and restaurants 6 ), usually when windows are closed and fresh air is mainly provided by a mechanical ventilation system ineffectively. For these poorly ventilated spaces, we can neglect the advective transport of aerosols due to air flows 30 , 31 . However, in well ventilated spaces, air flows play a more significant role in viral transmission 10 , 14 . Therefore, applying our model to well ventilated settings requires further validation with real-world data. We represent ventilation as a first-order removal of aerosols using a constant air exchange rate, \(\lambda\) . To quantify ventilation quality, we use air changes per hour (ACH), which is widely used by building engineers and space managers (ACH is converted to \(\lambda\) via \(1\ \textrm{ACH} \approx 2.78\times 10^{-4}\) air changes per second). Following the Wells–Riley ansatz 17 , 35 , we, thus, model the first-order removal of infectious aerosols with rate \(\kappa\) , which is a sum of the virus deactivation rate, gravitational settling rate, and ventilation rate, respectively, that is $$\begin{aligned} \kappa =\beta +\gamma +\lambda . \end{aligned}$$ (1) All parameter values are given in Table 1 . We approximate the diffusion coefficient of aerosols using the turbulent eddy diffusivity, an empirical function that considers local turbulent mixing 36 : $$\begin{aligned} D = 0.8\lambda {V}^{2/3}, \end{aligned}$$ (2) where V is the room volume. We assume a constant diffusion coefficient in each scenario we consider below, determined using the volume of the largest room. Movement of individuals might enhance the advective and diffusive transport of aerosols, as shown in the experiments of Mingotti et al. 37 , which would then cause a faster spread of the aerosols. Also, the effects of walking speed, crowd density and human-to-source distance on the diffusion coefficient have been investigated in the experiments of Lim et al. 38 ; some of these effects could be incorporated in future work. Each individual has several attributes: (I) whether they are infectious or susceptible, (II) whether they are a superspreader, (III) if they wear a mask, (IV) their walking speed, v , (V) their movement schedule. Each individual follows a schedule consisting of a list of events (e.g. “watching TV” or “attending a lecture”), and each event is characterised by a location ( x , y ) in a 2D plane, a start time, an end time, and an activity (resting, talking, talking loudly, exercising, and exercising intensively). Furthermore, each activity is characterised by a breathing rate and an aerosol emission rate; see Table 1 . We assume that an individual is either stationary or moving with a constant speed from an event to the next event, and that each individual always moves ahead of the end time of their current event to arrive exactly at the start time of the next event. We assume that each individual moves along the shortest path between the previous and next event locations (assuming they know the space well), and cannot move through domain boundaries and obstacles, such as walls and furniture. The trajectory \((x_i(t),y_i(t))\) of the i th individual is computed in “ Numerical implementation ”. Moreover, the infection risk of a susceptible individual depends on the total number of inhaled infectious aerosols (dose) 17 , 39 ; we assume that each individual needs the same dose to get infected. Modelling viral aerosols using a reaction-diffusion equation Based on the modelling assumptions above, a reaction-diffusion equation governs the concentration of infectious aerosols, C ( x , y , t ), in the indoor space, which is our domain \(\Omega\) : $$\begin{aligned} \frac{\partial {C}}{\partial {t}}=D\nabla ^2C+S-(\kappa +R_I){C}, \end{aligned}$$ (3) where S is the aerosol source term due to the aerosol emissions from the infectious individuals, \(R_I\) is the removal rate of infectious aerosols due to the breathing of all individuals, and \(\nabla =(\partial /\partial {x},\partial /\partial {y})\) , since we reduce the model to 2D. Perfect reflection of aerosols off walls corresponds to the Neumann boundary conditions \(\partial {C}/\partial {n}=0\) on \(\partial \Omega\) , where n is the outward normal direction. For m infectious individuals, the aerosol source is $$\begin{aligned} S(x,y,t) = \sum _{i=1}^m \frac{(1-\eta _i)R_i}{h}\delta (x-x_i(t))\delta (y-y_i(t)), \end{aligned}$$ (4) where \(\eta\) is the mask efficiency, R is the infectious aerosol emission rate, h is the room height, \(\delta\) is the Dirac delta function representing a point source, and the subscript i denotes the parameter value for the i th agent. All n individuals (both infectious and susceptible) due to breathing correspond to a point sink for the infectious aerosols $$\begin{aligned} R_I(x,y,t) = \sum _{i=1}^n (1-\eta _i)\rho _i\delta (x-x_i(t))\delta (y-y_i(t)), \end{aligned}$$ (5) where \(\rho\) is the breathing rate. The infectious aerosol emission rate, R , is calculated by \(R={\mu }R_t\) , where \(\mu\) is the viral load, which depends on the virus type and whether the infectious agent is a superspreader, and \(R_t\) is the aerosol emission rate, which depends on the activity. The viral load is estimated via $$\begin{aligned} \mu =\frac{\pi }{6}d_p^3c_v, \end{aligned}$$ (6) where \(d_p\) is the average aerosol diameter, and \(c_v\) is the viral load concentration (copies/mL) 40 . Spatiotemporal infection risk Following the Wells-Riley model 17 , 35 , we assume the infection risk of a susceptible individual is an exponential function of the dose, d , the number of inhaled infectious aerosols as follows, $$\begin{aligned} P(d)=1-e^{-Id}, \end{aligned}$$ (7) where I is infectibility, which depends on the median infectious dose \(d_m\) via \(I=-\ln (0.5)/d_m\) . The median infectious dose is the number of viral copies required to infect 50% of the individuals; the median dose depends on the disease 41 . The total number of inhaled infectious aerosols can be calculated by $$\begin{aligned} d(t)=\int _0^t(1-\eta ){\rho }C(x(\tau ),y(\tau ),\tau )d\tau . \end{aligned}$$ (8) We model viral transmission using a discrete S-I-R (Susceptible-Infectious-Removed) model 42 , where ‘R’ refers to the removal of individuals from the space. Removal takes place in some settings, e.g. in a supermarket, where infected individuals enter and then leave the space. Note that ‘R’ can also refer to recovery in some models 43 . However, since our simulations cover less than one day, recovery is not applicable here. Parameter values Table 1 summarises the parameters used in the simulations, for the SARS-CoV-2 virus. Note that our model can easily simulate other airborne diseases (influenza, MERS and SARS among others) by changing the values of parameters \(\beta\) , \(\mu\) , \(c_v\) and \(d_m\) . The value of \(c_v\) for the SARS-CoV-2 virus ranges from \(10^2\) to \(10^{11}\) copies/mL 40 ; the range of \(10^8\) – \(10^9\) copies/mL is most commonly used in modelling studies 12 , 44 , 45 , 46 . Here, we take \(c_v=10^9\ \mathrm {copies/mL}\) ( \(\mu =6.5\%\) ) for a “normal” infectious individual and \(c_v=5\times 10^9\ \mathrm {copies/mL}\) ( \(\mu =32.5\%\) ) for a superspreader 4 ; this was validated with data from a courtroom superspreader outbreak 12 . For the SARS-CoV-2 virus, the median infectious dose has been found to be 52 and 256 for seroconversion and fever, respectively, using an animal model 39 . Following Lau et al. 4 , we use \(d_m=100\) . The values of \(c_v\) and \(d_m\) will be further justified using uncertainty quantification in “ Courtroom ”. We consider three types of masks: cotton, surgical and N95, with efficiency 50%, 60% and 90%, respectively 47 , 48 . The breathing rate and the aerosol emission rate of an individual is based on their activity, which has been provided in Table 1 . When an individual is moving from one event to another, they are assumed to walk with speed 1.5 m/s 49 . The parameter values for walking and exercising are assumed to be the same. Table 1 Parameter values used in the simulations, for the SARS-CoV-2 virus. Values for \(\beta\) , \(\mu\) , \(c_v\) and \(d_m\) are different for other viruses. Full size table Numerical implementation The domain \(\Omega\) and the architectural design are constructed using topologicpy 18 , 19 , which has been extended to incorporate people movement for the purposes of this project. Topologicpy is a Python-based spatial modelling and topological analysis library that supports the conceptual design of architectures; details are given in a companion paper 20 . The first step is to create cuboids to represent rooms and corridors. The surfaces of the cuboids represent walls, floors or ceilings. Furniture is also modelled by cuboids. To simulate the movement of individuals, we generate a navigation graph, G , for the indoor space 20 . The vertices of this graph are the locations of all possible events, and the edges connecting the vertices represent all possible pathways an individual can move on. For each two neighbouring events, we compute on G the shortest path between the event locations 20 . Each individual moves with constant walking speed, and arrive exactly at the start time of the next event. The reaction-diffusion equation ( 3 ) is solved on \(\Omega\) using a finite element method (FEM) 54 . We generate a mesh for \(\Omega\) using the default Frontal-Delaunay algorithm in the gmsh library 55 . Then we discretise the time derivative using a backward Euler scheme, discretise the space using piecewise linear elements and compute the FEM problem at each time step using the Python-based open-source FEM library scikit-fem 56 . Note that using scikit-fem enables smooth integration with topologicpy in a lightweight fashion, since scikit-fem is smaller than 1MB in size and only uses NumPy 57 and SciPy 58 libraries, which are used in topologicpy 19 . VIRIS runs very fast; for example, for tens of individuals with a one-day schedule, it only takes seconds to compute the concentration and the infection risk on a standard laptop. All Python scripts can be found in a GitHub repository at https://github.com/KaterinaKaouri/VIRIS . Results In this section, we apply the simulator to three different indoor settings—courtroom, care home, and supermarket—to demonstrate the applicability of the model and its ability to model diverse NPIs. At the end, we present the VIRIS app, a user-friendly web app underpinned by the VIRIS simulator. Courtroom We consider a courtroom case study from Vaud, Switzerland, in October 2020. The locations, schedules and outcomes of all individuals are described in detail 12 . Three to four individuals were infected during a 3-hour court hearing 12 . This case study has also been modelled in Lau et al. 4 , and it was shown that the infectious individual has to be a superspreader. The courtroom had dimensions of \(8.9\ \textrm{m}\ (l)\times 5.6\ \textrm{m}\ (w)\times 3\ \textrm{m}\ (h)\) , so the room volume is 150 \(\mathrm {m^3}\) . The room was very poorly ventilated, with \(\textrm{ACH}=0.23\ \mathrm {h^{-1}}\) ( \(\lambda =6.4\times 10^{-5}\ \mathrm {s^{-1}}\) ). Using equation ( 2 ), the diffusion coefficient is determined to be \(D=1.4\times 10^{-3}\ \mathrm {m^2/s}\) . The hearing involved 10 individuals ( \(\mathrm {P_1}\) – \(\mathrm {P_{10}}\) ), with locations as shown in Figure 1 a. Fig. 1 Courtroom scenario: ( a ) the location of each individual, and their infection status ( \(\CIRCLE\) for infectious, \(\bigoplus\) for infected, and \(\bigcirc\) for not infected) 12 . ( b ) The activities of each individual during the hearing and the breaks 12 . ( c ) Probability of the model reproducing ( a ), calculated by Eq. ( 9 ), as \(\mu\) varies from 0 to \(100\%\) and \(d_m\) varies from 50 to 260. The red cross indicates the parameter values used in our work. The purple dashed box encloses the possible values 12 , 39 , 40 , 46 . Full size image The court hearing lasted from 2:00 p.m. to 5:00 p.m. There were breaks from 2:00 p.m. to 2:05 p.m., from 2:23 p.m. to 2:30 p.m., from 2:55 p.m. to 3:10 p.m., and from 3:44 p.m. to 3:50 p.m., during which only the jury members \(\mathrm {P_1}\) – \(\mathrm {P_4}\) remained in the room 12 . The witness \(\mathrm {P_{10}}\) was only present from 3:10 p.m. to 3:44 p.m. As shown in Fig. 1 a, \(\mathrm {P_1}\) was the only infectious individual, and is assumed to be a superspreader with \(\mu =32.5\%\) . \(\mathrm {P_2}\) , \(\mathrm {P_3}\) , \(\mathrm {P_4}\) and \(\mathrm {P_5}\) were found infected after the hearing. However, \(\mathrm {P_5}\) had contact with another infectious individual before this hearing, so we assume that \(\mathrm {P_5}\) was not infected during the hearing. The activities of each individual during the hearing are listed in Fig. 1 b. All other parameters are as in Table 1 . We perform a parameter sweep for \(\mu\) and \(d_m\) to examine which pair of parameter values results in the highest probability, $$\begin{aligned} p = \prod _{i=2}^{4}P_i\prod _{i=5}^{10}(1-P_i), \end{aligned}$$ (9) of reproducing exactly the infection data reported in Vernez et al. 12 ( \(\mathrm {P_2}\) – \(\mathrm {P_4}\) infected and \(\mathrm {P_5}\) – \(\mathrm {P_{10}}\) not infected). Figure 1 visualises p for \(\mu\) ranging from 0 to 100% and \(d_m\) ranging from 50 to 260. The purple dashed box encloses possible values of these parameters 12 , 39 , 40 , 46 . Note that we allowed \(\mu\) to be an order of magnitude greater than the upper limit used in recent modelling studies 12 , 46 , but still within the range found in experimental work 40 . The red cross indicates the parameter values used in this paper, which falls within the region where we cannot reject the null hypothesis, that our model exactly reproduces the reality since \(p>0.05\) . Figure 2 a shows the concentration of infectious aerosols at the end of the hearing (5:00 p.m.). Figure 2 b shows the infection risk of each susceptible individual over time, where orange colour represents the individuals who are infected after the hearing, while green colour represents who are not. We set the threshold of infection risk at 50% to determine whether a susceptible individual is infected. Note that a different threshold will result in a different number of infected people (e.g. \(\mathrm {P_3}\) will also be found to be infected, if we set the threshold at 35%). Fig. 2 Courtroom scenario: ( a ) the location of each individual, their infection status (red colour for infectious, orange colour for infected, and green colour for not infected), and the concentration of infectious aerosols at the end of the hearing (5:00 p.m.). The threshold of infection risk was set at 50% for an individual to get infected. ( b ) The infection risk of susceptible individuals, \(\mathrm {P_2}\) , \(\mathrm {P_3}\) , \(\mathrm {P_4}\) , \(\mathrm {P_5}\) , \(\mathrm {P_6}\) , \(\mathrm {P_{10}}\) . Individuals \(\mathrm {P_7}\) , \(\mathrm {P_8}\) and \(\mathrm {P_9}\) are omitted from this plot, since their infection risk curve is low (below 50%), and approximately equal to that of \(\mathrm {P_6}\) . Full size image As shown in Fig. 1 a, \(\mathrm {P_2}\) and \(\mathrm {P_4}\) were closest to the infectious individual \(\mathrm {P_1}\) (at 1.5 m) during the entire 3-h hearing, where a high infectious aerosol concentration and infection risk is predicted by the model. \(\mathrm {P_3}\) was also present in the entire hearing but was slightly further away from \(\mathrm {P_1}\) (at 3 m); \(\mathrm {P_3}\) , thus, has the third highest infection risk. \(\mathrm {P_5}\) and \(\mathrm {P_{10}}\) were at a similar distance from \(\mathrm {P_1}\) ; \(\mathrm {P_5}\) has a much higher infection risk than \(\mathrm {P_{10}}\) , as \(\mathrm {P_{10}}\) was only present in the courtroom for only 34 min. This result confirms that both proximity and duration of contact have significant impact on the infection risk. Care home Next, we consider a typical section of a UK care home 59 , where six individuals ( \(\mathrm {P_1}\) – \(\mathrm {P_6}\) ) move around from 8:00 a.m. to 11:00 p.m. One of the individuals ( \(\mathrm {P_1}\) ) is infectious. This scenario demonstrates the versatility of our model to consider different agent schedules and NPIs. Many of the NPIs we study below were suggested by the UK government during the pandemic 60 . The care home has dimensions of \(14\ \textrm{m}\ (l)\times 13\ \textrm{m}\ (w)\times 3\ \textrm{m}\ (h)\) , and includes five bedrooms (BRs) and two common rooms (CRs), as shown in Fig. 3 . We assume that each individual is in one of the two common rooms from 9:00 a.m. to 12:00 p.m. ( \(\mathrm {P_1}\) , \(\mathrm {P_3}\) , \(\mathrm {P_5}\) in CR1; \(\mathrm {P_2}\) , \(\mathrm {P_4}\) , \(\mathrm {P_6}\) in CR2), from 2:00 p.m. to 5:00 p.m. ( \(\mathrm {P_1}\) , \(\mathrm {P_2}\) , \(\mathrm {P_3}\) in CR1; \(\mathrm {P_4}\) , \(\mathrm {P_5}\) , \(\mathrm {P_6}\) in CR2), and from 5:00 p.m. to 8:00 p.m. ( \(\mathrm {P_4}\) , \(\mathrm {P_5}\) , \(\mathrm {P_6}\) in CR1; \(\mathrm {P_1}\) , \(\mathrm {P_2}\) , \(\mathrm {P_3}\) in CR2). At any other time, each individual is in their bedroom (see Fig. 3 a). Each individual is assumed to be resting when in the bedroom and talking in a common room. Fig. 3 Care home scenario. Each individual is represented by a cylinder and gives a colour according to their infection status. The concentration of infectious aerosols is represented using a colour scale. Two snapshots of the simulation are shown at ( a ) 8:30 a.m. (all individuals are resting in their bedrooms) and ( b ) 5:30 p.m. At 5:30 p.m., three more individuals are likely to be infected. Full size image We assume \(\mathrm {P_1}\) is a superspreader ( \(\mu =32.5\%\) ) and that the ventilation is very poor ( \(\lambda =3.3{\times }10^{-5}\ \mathrm {s^{-1}}\) , \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) ). We set \(D=4.6\times 10^{-4}\ \mathrm {m^2/s}\) using the common room volume \(V=72\ \mathrm {m^3}\) in equation ( 2 ). We model the movement of individuals based on the prescribed schedule and simulate the concentration of infectious aerosols in the common room and the infection risk of each individual. Figure 3 b presents the infectious aerosol concentration and the six individuals’ locations at 5:30pm; we see that three individuals ( \(\mathrm {P_2}\) , \(\mathrm {P_3}\) , \(\mathrm {P_5}\) ) have already gotten infected by \(\mathrm {P_1}\) . We compare six NPIs: (I) improving ventilation from \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) to \(\textrm{ACH}=3\ \mathrm {h^{-1}}\) (note that the ASHRAE recommended minimum ventilation setting for care homes is 2–4 \(\mathrm {h^{-1}}\) ) 61 , (II) everyone wears a surgical mask ( \(\eta =60\%\) ), (III) no common room time, (IV) reducing the time in the common room by 50%, (V) introducing a two-hour break with no access to the common room from 5:00 p.m. to 7:00 p.m., and delaying the third common room gathering to 7:00 p.m. to 10:00 p.m. (VI) individuals only interact within 2 small social groups of three. Interventions I, III and IV correspond to the UK government’s guidance on infection prevention and control measures for social care providers and managers, as updated in July, 2024 60 . The NPIs we choose showcase how easy is to customise our model to assess diverse interventions, and provide useful comparisons. For instance, we design intervention V because we observe that \(\mathrm {P_1}\) leaves behind them a high concentration of infectious aerosols; individuals entering the space after \(\mathrm {P_1}\) inhale the aerosols (see the purple regions in CR1 of Fig. 3 b) and, thus, experience higher infection risk. In Fig. 4 , we present the average infection risk of the five susceptible individuals \(\mathrm {P_2}\) – \(\mathrm {P_6}\) in the original scenario, and when implementing interventions I–VI. The average infection risk is calculated as the sum of infection risk of all susceptible individuals, divided by the number of susceptible individuals. The most effective intervention is, as expected, III (no common room time), where the infection risk is zero, since there is no contact between the infectious individual and others. The second most effective intervention is II (everyone wears a surgical mask), which reduces the average infection risk by more than 40%. The third most effective intervention is I (improving ventilation), followed by intervention VI (individuals only interact within two small social groups of three), which also results in a reduction of more than 30% in the average infection risk. The other two interventions (IV, V) show similar effectiveness and reduce the average infection risk by approximately 15%. Fig. 4 The average infection risk of the five susceptible individuals in the original care home scenario, and when implementing six different NPIs: (I) improving ventilation from \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) to \(\textrm{ACH}=3\ \mathrm {h^{-1}}\) , (II) everyone wears a surgical mask ( \(\eta =60\%\) ), (III) no common room time, (IV) reducing common room time by 50%, (V) introducing a two-hour break with no access to the common room from 5:00 p.m. to 7:00 p.m., and moving the third common room event to 7:00 p.m. to 10:00 p.m. (VI) individuals only interact within two small social groups of three. Full size image Supermarket Here, we study a small supermarket and use the model to visualise infection hotspots and again compare several NPIs. The supermarket has dimensions of \(14\ \textrm{m}\ (l)\times 14\ \textrm{m}\ (w)\times 3\ \textrm{m}\ (h)\) , as shown in Fig. 5 a. We assume that the ventilation is very poor ( \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) , i.e. \(\lambda =3.3{\times }10^{-5}\ \mathrm {s^{-1}}\) and \(D=1.9\times 10^{-3}\ \mathrm {m^2/s}\) ). Fig. 5 Supermarket scenario: ( a ) the concentration of infectious aerosols at 10:00am. Individuals are represented by cylinders (infectious by red colour and susceptible by green colour). The average concentration of infectious aerosols during the ( b ) first hour (8:00 a.m.–9:00 a.m.) and ( c ) last hour of opening (11:00 a.m.–12:00 p.m.). Full size image We generate random schedules for the individuals. Each individual enters the supermarket from the door, picks up a basket, chooses items from the shelves, pays at a checkout and exits through the same door. An individual’s schedule is primarily determined by three parameters: frequency of customers entering the supermarket, f , the number of items each customer will buy, N , and the time it takes to choose each item, T . We set \(f=1\ \textrm{min}^{-1}\) , \(N=6\) , and T uniformly distributed from 40 to 80 s, that is the average T is 60 s and standard deviation is equal to 11.55 s. The locations of the six items are uniformly randomly assigned on the boundary of shelves. The middle two checkouts are closed for the original scenario (these two will be opened for a NPI). The customer pays at one of the other two checkouts randomly, when they are not being used. The checkout time is also \(T=60{\pm }11.55\ \textrm{s}\) (defined by a continuous uniform distribution between 40 and 80 s). Each customer, thus, spends an average of 7.5 min in the supermarket. From 8:00 a.m. to 12:00 p.m., 240 individuals, thus, enter the supermarket. As in the care home scenario, we assume that 1/6 of the individuals are infectious (40 individuals are infectious and 200 individuals are susceptible), and that all infectious individuals are not superspreaders ( \(\mu =6.5\%\) ). Figure 5 a shows the concentration of infectious aerosols at 10:00 a.m. (2 h since the start time). There are two infectious individuals and eight susceptible individuals, represented by red and green colours, respectively. Figure 5 b,c present the average concentration of infectious aerosols in the supermarket during the (b) first and (c) last hour of opening, where it accumulates over time and hotspots are identified in busy aisles and checkout regions. Next, we compare five interventions: (I) improving ventilation from \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) to \(\textrm{ACH}=3\ \mathrm {h^{-1}}\) (based on the baseline ventilation of a small shop 34 ), (II) all customers wear a surgical mask ( \(\eta =60\%\) ), (III) halving the number of people entering, (IV) reducing the duration of shopping for each customer by 50% ( \(T=20\) – \(40\ \textrm{s}\) ), (V) opening also the two middle checkouts to avoid crowding. Interventions III, IV and V are based on the UK government’s guidance for consumers on COVID-19 and food 62 . We simulate interventions I and II using the original schedule, and we generate new schedules to implement III, IV and V. Figure 6 shows the infection risk of susceptible individuals under the original scenario, and when implementing the interventions I–V. Since the supermarket opens, the infection risk increases for approximately 3 h, due to the accumulation of infectious aerosols, as shown in Fig. 5 b,c, then reaches a steady state value during the last hour. For each intervention, the simulation results are fitted to a logistic curve for comparison. Here, we choose the logistic curve, because it exhibits a quasi-linear phase first, followed by a saturation phase, which mimics the observed trend in the infection risk evolution. Fig. 6 The infection risk of susceptible individuals in the original supermarket scenario, and when implementing different NPIs: (I) improving ventilation from \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) to \(\textrm{ACH}=3\ \mathrm {h^{-1}}\) , (II) all wearing a surgical mask ( \(\eta =60\%\) ), (III) halving the number of people entering, (IV) reducing the duration of shopping for each customer by 50% ( \(T=30 \textrm{s}\) ), (V) opening another two checkouts. The dots represent infection risk of each susceptible individual leaving the supermarket. For each intervention, a logistic curve is fitted to the infection risk data. Full size image If we compare the infection risk at 12:00 p.m., the most effective intervention is II (wearing a surgical mask), which reduces the infection risk by 2.8%. The second most effective intervention is I (improving ventilation to \(\textrm{ACH}=3\ \mathrm {h^{-1}}\) ), which reduces the infection risk by 2.4%. The third most effective intervention is IV (reducing shopping time by 50%), which reduces the infection risk by 2.3%, followed by intervention III (halving the number of people entering), reducing the infection risk by 1.3%. The opening of two more checkouts, however, shows insignificant impact on the infection risk in the scenario considered here. Web app In this section, we have used VIRIS to study infection spread in three different indoor settings, and demonstrated its ability to assess diverse NPIs. We have also developed a user-friendly web app ( https://viris.app ). The app will enable policymakers and space managers to assess NPIs and issue evidence-based guidance, architects to assess architectural designs, and the general public to get a better understanding of NPIs and their relative role in reducing the infection risk. Figure 7 shows three screenshots of the VIRIS app. Figure 7 a shows the Landing Page. Figure 7 b presents the Overview panel of the Wizard to set up a simulation. The wizard allows the user to set up the simulation step-by-step: the users can import their own architectural geometry or select from preset scenarios, specify people movements, and set parameter values. The simulation is executed at the last step pressing “Run”, and the simulation results are shown on the Simulation Playground, as shown in Fig. 7 c. At the Simulation Playground, the users can export their simulation results (including raw data) to their local machine. The user can visualise the simulation as an animation (3D or 2D), see a summary table and also a plot of the individuals’ infection risk over time. The users can also use the scroll bar on the bottom to visualise a specific time step of the simulation. Fig. 7 Screenshots of the web app: ( a ) Landing page, ( b ) Wizard for setting up the simulation, and ( c ) Simulation playground for visualising the results. Full size image The app has been discussed with the Welsh Government and we are looking into using it to study various indoor settings according to the government’s priorities. Discussion In this paper, we present VIRIS, a new epidemic simulator that combines airborne viral transmission, people movement, and detailed architectural design 19 , 20 . The modelling framework couples airborne transmission modelling based on the Wells–Riley ansatz 4 , 17 , 35 with agent-based simulations of individuals’ movement, and the architectural software topologicpy 19 , 20 . VIRIS enables fast simulations employing a finite element method to solve the reaction-diffusion equation ( 3 ) for the viral concentration; a simulation of tens of individuals moving over a whole day can be computed within 1 min on a standard laptop. The model’s versatility and applicability has been demonstrated in three indoor settings: courtroom, care home and supermarket. The model aims to enable policymakers and space managers to assess and issue guidance to mitigate the transmission of airborne diseases in indoor spaces. In addition, it could help architects and engineers to assess designs that mitigate infection risk 20 . In this work, we examine and rank different NPIs, many of those included in UK Government guidance, for care homes 60 (Fig. 4 ) and for a small supermarket 62 (Fig. 6 ). Three NPIs have been studied for both the care home and the supermarket: improving ventilation, wearing a surgical mask, and reducing the duration of person-person interactions. Based on our simulations, wearing a surgical mask (60% efficiency) has been found to be the most effective NPI in both cases. Improving ventilation from \(\textrm{ACH}=0.12\ \mathrm {h^{-1}}\) to \(\textrm{ACH}=3\ \mathrm {h^{-1}}\) (25-fold increase) is the second most effective intervention in both scenarios. While we expect that the infection risk exhibits a monotonic decrease with increasing ACH, we instead see a rise in the risk when ACH improves from 0.1 to 0.4 \(\mathrm {h^{-1}}\) in the courtroom, as presented in Supplementary Fig. S1 online. The impact of ACH on the infection risk is determined by the competition between the diffusion and ventilation terms in equation ( 3 ). Based on the simulation results, the diffusion dominates for small ACH, particularly in scenarios where individuals remain stationary, causing the infection risk to rise, while the ventilation term dominates for larger ACH, causing the infection risk to decrease. In addition, we highlight the importance of designing and studying scenario-customised NPIs. For example, we consider socialising within small groups in the care home, and show that it is the third most effective intervention following imposing no common room time and everyone wearing a surgical mask. In the supermarket, we instead study halving the number of customers and opening two more checkouts. The former intervention greatly reduces the infection risk, while the latter one is found to be ineffective. These results underscore the need to assess interventions specific to each setting, a task our model can easily fulfil. We emphasise that all results presented here are specific to the parameters, indoor layout, and schedules used in this paper. These are used to showcase the ease of customising our model to evaluate diverse NPIs, rather than to recommend any particular NPI for real-world application. The quantitative results and conclusions need further validation and verification before being used to inform decisions. Change of parameters can be very easily done in VIRIS and this is further facilitated by the VIRIS app. The care home and the supermarket are studied based on typical but fictitious designs 59 ; model calibration using real geometries is needed before using VIRIS to inform decision-making in real life. Model calibration for various real settings is in development through our collaboration with policymakers, space managers and architects. Moreover, extensions in the modelling framework can be undertaken; for instance, to consider multi-level buildings and to solve equation ( 3 ) in three dimensions. These extensions can be well supported by topologicpy 19 , 20 , but require substantial changes in the simulator and the web app. Future work could also incorporate more detailed fluid dynamics models 4 , 10 , 14 , 37 , 38 , 63 , 64 , but preserving computational efficiency would then be very challenging. In conclusion, we have presented VIRIS, a modelling framework, simulator and app for airborne viral transmission, which combines detailed people movement and architectural design. We have demonstrated the applicability and versatility of VIRIS by studying several NPIs in a care home and a supermarket. Data availability Data and relevant code for this research work are stored in a GitHub repository: https://github.com/KaterinaKaouri/VIRIS . References World Health Organization. Who COVID-19 dashboard (2024) (accessed 13 Jul 2024). Asadi, S., Bouvier, N., Wexler, A. S. & Ristenpart, W. D. The coronavirus pandemic and aerosols: Does COVID-19 transmit via expiratory particles?. Aerosol Sci. Technol. 54 , 635–638. https://doi.org/10.1080/02786826.2020.1749229 (2020). Article ADS CAS Google Scholar Wang, C. C. et al. Airborne transmission of respiratory viruses. Science . 373 . https://doi.org/10.1126/science.abd9149 (2021). Lau, Z., Griffiths, I. M., English, A. & Kaouri, K. Predicting the spatio-temporal infection risk in indoor spaces using an efficient airborne transmission model. Proc. R. Soc. A Math. Phys. Eng. Sci. 478 , 20210383. https://doi.org/10.1098/rspa.2021.0383 (2022). Article ADS Google Scholar Moore, J. W., Lau, Z., Kaouri, K., Dale, T. C. & Woolley, T. E. A general computational framework for COVID-19 modelling with applications to testing varied interventions in education environments. COVID 1 , 674–703. https://doi.org/10.3390/covid1040055 (2021). Article CAS Google Scholar Li, Y. et al. Probable airborne transmission of SARS-CoV-2 in a poorly ventilated restaurant. Build. Environ. 196 , 107788. https://doi.org/10.1016/j.buildenv.2021.107788 (2021). Article PubMed PubMed Central Google Scholar Balkan, B. A. et al. The multi-dimensional challenges of controlling respiratory virus transmission in indoor spaces: Insights from the linkage of a microscopic pedestrian simulation and SARS-CoV-2 transmission model. PLoS Comput. Biol. 20 . https://doi.org/10.1371/journal.pcbi.1011956 (2024). Xu, Q. & Chraibi, M. On the effectiveness of the measures in supermarkets for reducing contact among customers during COVID-19 period. Sustainability 12 , 1–14. https://doi.org/10.3390/su12229385 (2020). Article CAS Google Scholar Ying, F. & O’Clery, N. Modelling COVID-19 transmission in supermarkets using an agent-based model. PLoS One 16 . https://doi.org/10.1371/journal.pone.0249821 (2021). Cui, F. et al. Transport and fate of virus-laden particles in a supermarket: Recommendations for risk reduction of COVID-19 spreading. J. Environ. Eng. (U.S.) 147 . https://doi.org/10.1061/(ASCE)EE.1943-7870.0001870 (2021). Miller, S. L. et al. Transmission of SARS-CoV-2 by inhalation of respiratory aerosol in the skagit valley chorale superspreading event. Indoor Air 31 , 314–323. https://doi.org/10.1111/ina.12751 (2021). Article CAS PubMed Google Scholar Vernez, D., Schwarz, S., Sauvain, J.-J., Petignat, C. & Suarez, G. Probable aerosol transmission of SARS-CoV-2 in a poorly ventilated courtroom. Indoor Air 31 , 1776–1785. https://doi.org/10.1111/ina.12866 (2021). Article CAS PubMed PubMed Central Google Scholar de Kreij, R. J. B., Davies Wykes, M. S., Woodward, H. & Linden, P. F. Modeling disease transmission in a train carriage using a simple 1D-model. Indoor Air . 32 . https://doi.org/10.1111/ina.13066 (2022). Zhen, Q. et al. Overview of the role of spatial factors in indoor SARS-CoV-2 transmission: A space-based framework for assessing the multi-route infection risk. Int. J. Environ. Res. Public Health . 19 . https://doi.org/10.3390/ijerph191711007 (2022). Ciunkiewicz, P., Brooke, W., Rogers, M. & Yanushkevich, S. Agent-based epidemiological modeling of COVID-19 in localized environments. Comput. Biol. Med. 144 . https://doi.org/10.1016/j.compbiomed.2022.105396 (2022). Luca, A. B. COVID-19 Preventive Measures Simulation Supermarket Case Study . Bachelor’s thesis, Tilburg University/Eindhoven University of Technology (2022). Riley, E., Murphy, G. & Riley, R. Airborne spread of measles in a suburban elementary school. Am. J. Epidemiol. 107 , 421–432. https://doi.org/10.1093/oxfordjournals.aje.a112560 (1978). Article CAS PubMed Google Scholar Jabi, W. & Chatzivasileiadi, A. Topologic: Exploring spatial reasoning through geometry, topology, and semantics. In Formal Methods in Architecture (eds. Eloy, S., Leite Viana, D., Morais, F. & Vieira Vaz, J.) 277–285 (Springer International Publishing, 2021). Jabi, W. Topologicpy. https://doi.org/10.5281/zenodo.11555173 (2024). Jabi, W., Xue, Y., Woolley, T. E. & Kaouri, K. 3D topological modeling and multi-agent movement simulation for improved infection risk analysis. arXiv [SPACE] https://doi.org/10.48550/arXiv.2408.16417 (2024). Bourouiba, L., Dehandschoewercker, E. & Bush, J. W. Violent expiratory events: on coughing and sneezing. J. Fluid Mech. 745 , 537–563. https://doi.org/10.1017/jfm.2014.88 (2014). Article ADS Google Scholar Johnson, G. et al. Modality of human expired aerosol size distributions. J. Aerosol Sci. 42 , 839–851. https://doi.org/10.1016/j.jaerosci.2011.07.009 (2011). Article ADS CAS Google Scholar Bagheri, G. et al. Size, concentration, and origin of human exhaled particles and their dependence on human factors with implications on infection transmission. J. Aerosol Sci. 168 . https://doi.org/10.1016/j.jaerosci.2022.106102 (2023). De Oliveira, P., Mesquita, L., Gkantonas, S., Giusti, A. & Mastorakos, E. Evolution of spray and aerosol from respiratory releases: Theoretical estimates for insight on viral transmission. Proc. R. Soc. A Math. Phys. Eng. Sci. 477 . https://doi.org/10.1098/rspa.2020.0584 (2021). Wells, W. On air-borne infection: Study II. droplets and droplet nuclei. Am. J. Epidemiol. 20 , 611–618. https://doi.org/10.1093/oxfordjournals.aje.a118097 (1934). Article Google Scholar Xie, X., Li, Y., Chwang, A., Ho, P. & Seto, W. How far droplets can move in indoor environments—revisiting the wells evaporation-falling curve. Indoor Air 17 , 211–225. https://doi.org/10.1111/j.1600-0668.2007.00469.x (2007). Article CAS PubMed Google Scholar Dabisch, P. et al. The influence of temperature, humidity, and simulated sunlight on the infectivity of SARS-CoV-2 in aerosols. Aerosol Sci. Technol. 55 , 142–153. https://doi.org/10.1080/02786826.2020.1829536 (2021). Article ADS CAS PubMed Google Scholar Aganovic, A. et al. Estimating the impact of indoor relative humidity on SARS-CoV-2 airborne transmission risk using a new modification of the Wells-Riley model. Build. Environ. 205 . https://doi.org/10.1016/j.buildenv.2021.108278 (2021). Van Doremalen, N. et al. Aerosol and surface stability of SARS-CoV-2 as compared with SARS-CoV-1. N. Engl. J. Med. 382 , 1564–1567. https://doi.org/10.1056/NEJMc2004973 (2020). Article PubMed Google Scholar Bhagat, R. K., Davies Wykes, M., Dalziel, S. B. & Linden, P. Effects of ventilation on the indoor spread of COVID-19. J. Fluid Mech. 903 . https://doi.org/10.1017/jfm.2020.720 (2020). Bhagat, R. K., Dalziel, S. B., Wykes, M. D. & Linden, P. Building ventilation: The consequences for personal exposure. Annu. Rev. Fluid Mech. 56 , 405–434. https://doi.org/10.1146/annurev-fluid-120720-015857 (2024). Article ADS Google Scholar Guo, H., Morawska, L., He, C. & Gilbert, D. Impact of ventilation scenario on air exchange rates and on indoor particle number concentrations in an air-conditioned classroom. Atmos. Environ. 42 , 757–768. https://doi.org/10.1016/j.atmosenv.2007.09.070 (2008). Article ADS CAS Google Scholar Srikanth, P., Doe, R. L., Croteau, G. & Cohen, M. A. Low-cost interventions to improve ventilation in long-term care facilities. J. Occup. Environ. Hyg. 21 , 379–388. https://doi.org/10.1080/15459624.2024.2328295 (2024). Article PubMed Google Scholar Li, C. et al. Field study to characterize customer flow and ventilation rates in retail buildings in Shenzhen, China. Build. Environ. 197 , 107837. https://doi.org/10.1016/j.buildenv.2021.107837 (2021). Article PubMed PubMed Central Google Scholar Wells, W. F. Airborne Contagion and Air Hygiene: An Ecological Study of Droplet Infections (Harvard University Press, 1955). Foat, T., Drodge, J., Nally, J. & Parker, S. A relationship for the diffusion coefficient in eddy diffusion based indoor dispersion modelling. Build. Environ. 169 . https://doi.org/10.1016/j.buildenv.2019.106591 (2020). Mingotti, N., Wood, R., Noakes, C. & Woods, A. W. The mixing of airborne contaminants by the repeated passage of people along a corridor. J. Fluid Mech. 903 . https://doi.org/10.1017/jfm.2020.671 (2020). Lim, H., Foat, T. G., Parker, S. T. & Vanderwel, C. On the effects of walking speed, crowd density and human-to-source distance on pollutant dispersion in indoor spaces. Build. Environ. 259 . https://doi.org/10.1016/j.buildenv.2024.111649 (2024). Dabisch, P. A. et al. Seroconversion and fever are dosepependent in a nonhuman primate model of inhalational COVID-19. PLoS Pathog. 17 . https://doi.org/10.1371/journal.ppat.1009865 (2021). Anand, S. & Mayya, Y. Size distribution of virus laden droplets from expiratory ejecta of infected subjects. Sci. Rep. 10 . https://doi.org/10.1038/s41598-020-78110-x (2020). Qiu, G. et al. On-site airborne pathogen detection for infection risk mitigation. Chem. Soc. Rev. 52 , 8531–8579. https://doi.org/10.1039/d3cs00417a (2023). Article CAS PubMed PubMed Central Google Scholar Allen, L. J. Some discrete-time SI, SIR, and SIS epidemic models. Math. Biosci. 124 , 83–105. https://doi.org/10.1016/0025-5564(94)90025-6 (1994). Article CAS PubMed Google Scholar Chen, Y.-C., Lu, P.-E., Chang, C.-S. & Liu, T.-H. A time-dependent SIR model for COVID-19 with undetectable infected persons. IEEE Trans. Netw. Sci. Eng. 7 , 3279–3294. https://doi.org/10.1109/TNSE.2020.3024723 (2020). Article MathSciNet PubMed Google Scholar Srinivasan, A., Krishan, J., Bathula, S. & Mayya, Y. S. Modeling the viral load dependence of residence times of virus-laden droplets from COVID-19-infected subjects in indoor environments. Indoor Air 31 , 1786–1797. https://doi.org/10.1111/ina.12868 (2021). Article CAS PubMed PubMed Central Google Scholar Bagheri, G., Thiede, B., Hejazi, B., Schlenczek, O. & Bodenschatz, E. An upper bound on one-to-one exposure to infectious human respiratory particles. Proc. Natl. Acad. Sci. U.S.A. 118 . https://doi.org/10.1073/pnas.2110117118 (2021). Buonanno, G., Stabile, L. & Morawska, L. Estimation of airborne viral emission: Quanta emission rate of SARS-CoV-2 for infection risk assessment. Environ. Int. 141 . https://doi.org/10.1016/j.envint.2020.105794 (2020). Lindsley, W. G., Blachere, F. M., Law, B. F., Beezhold, D. H. & Noti, J. D. Efficacy of face masks, neck gaiters and face shields for reducing the expulsion of simulated cough-generated aerosols. Aerosol Sci. Technol. 55 , 449–457. https://doi.org/10.1080/02786826.2020.1862409 (2021). Article ADS CAS PubMed PubMed Central Google Scholar Asadi, S. et al. Efficacy of masks and face coverings in controlling outward aerosol particle emission from expiratory activities. Sci. Rep. 10 . https://doi.org/10.1038/s41598-020-72798-7 (2020). Bosina, E. & Weidmann, U. Estimating pedestrian speed using aggregated literature data. Phys. A 468 , 1–29. https://doi.org/10.1016/j.physa.2016.09.044 (2017). Article Google Scholar Orton, C. M. et al. A comparison of respiratory particle emission rates at rest and while speaking or exercising. Commun. Med. 2 , 44–44. https://doi.org/10.1038/s43856-022-00103-w (2022). Article PubMed PubMed Central Google Scholar Mutsch, B. et al. Aerosol particle emission increases exponentially above moderate exercise intensity resulting in superemission during maximal exercise. Proc. Natl. Acad. Sci. 119 , e2202521119. https://doi.org/10.1073/pnas.2202521119 (2022). Article CAS PubMed PubMed Central Google Scholar Berry, M. J. Increased ventilation in runners during running as compared to walking at similar metabolic rates. Eur. J. Appl. Physiol. 73 , 245–250. https://doi.org/10.1007/BF02425483 (1996). Article CAS Google Scholar Asadi, S. et al. Aerosol emission and superemission during human speech increase with voice loudness. Sci. Rep. 9 . https://doi.org/10.1038/s41598-019-38808-z (2019). Langtangen, H. P. & Logg, A. Solving PDEs in Python: the FEniCS tutorial I (Springer Nature, 2017). Geuzaine, C. & Remacle, J.-F. Gmsh: A 3-d finite element mesh generator with built-in pre- and post-processing facilities. Int. J. Numer. Method Eng. 79 , 1309–1331. https://doi.org/10.1002/nme.2579 (2009). Article MathSciNet Google Scholar Gustafsson, T. & McBain, G. D. scikit-fem: A Python package for finite element assembly. J. Open Source Softw. 5 , 2369. https://doi.org/10.21105/joss.02369 (2020). Harris, C. R. et al. Array programming with NumPy. Nature 585 , 357–362. https://doi.org/10.1038/s41586-020-2649-2 (2020). Article ADS CAS PubMed PubMed Central Google Scholar Fundamental Algorithms for Scientific Computing in Python. Virtanen, P. et al. SciPy 1.0. Nat. Methods 17 , 261–272. https://doi.org/10.1038/s41592-019-0686-2 (2020). Article CAS Google Scholar Khaliq, K. A. et al. Environmental data monitoring and infection risks in UK care-homes in the context of COVID-19. Build. Environ. 250 . https://doi.org/10.1016/j.buildenv.2024.111174 (2024). Department of Health & Social Care & UK Health Security Agency. Infection prevention and control (IPC) in adult social care: acute respiratory infection (ARI) (2024) (accessed 02 Jul 2024). ANSI/ASHRAE/ASHE. ANSI/ASHRAE/ASHE Standard 170-2021, Ventilation of health care facilities (2021) (accessed 13 Oct 2024). Food Standards Agency. Guidance for consumers on coronavirus (COVID-19) and food (2020). (accessed 09 Jul 2024). Jia, W., Wei, J., Cheng, P., Wang, Q. & Li, Y. Exposure and respiratory infection risk via the short-range airborne route. Build. Environ. 219 . https://doi.org/10.1016/j.buildenv.2022.109166 (2022). Pretty, A., Griffiths, I. M., Lau, Z. & Kaouri, K. The effect of local ventilation on airborne viral transmission in indoor spaces. arXiv . https://doi.org/10.48550/arXiv.2309.16332 (2023). Download references Acknowledgements This work is funded by an EPSRC Impact Acceleration Account grant, under grant number EP/X525522/1. We would like to acknowledge fruitful discussions with Dr Rob Orford and Dr Brendan Collins, while they held, respectively, the posts of Chief Scientific Advisor (Health) and Head of Health Economics, Advanced Analysis and Policy Modelling in the Welsh Government. Author information Authors and Affiliations School of Mathematics, Cardiff University, Cardiff, CF24 4AG, UK Yidan Xue, Thomas E. Woolley & Katerina Kaouri School of Health Sciences, The University of Manchester, Manchester, M13 9PL, UK Yidan Xue Welsh School of Architecture, Cardiff University, Cardiff, CF10 3NB, UK Wassim Jabi Authors Yidan Xue View author publications Search author on: PubMed Google Scholar Wassim Jabi View author publications Search author on: PubMed Google Scholar Thomas E. Woolley View author publications Search author on: PubMed Google Scholar Katerina Kaouri View author publications Search author on: PubMed Google Scholar Contributions Y.X.: Conceptualization, methodology, software, validation, formal analysis, data curation, writing—original draft, visualization. W.J.: Methodology, software, writing—review and editing, visualization, supervision, funding acquisition. T.E.W.: Conceptualization, methodology, formal analysis, writing—review and editing, supervision, funding acquisition. K.K.: Conceptualization, methodology, formal analysis, writing—review and editing, supervision, project administration, funding acquisition. Corresponding author Correspondence to Katerina Kaouri . Ethics declarations Competing interests The authors declare no competing interests. Additional information Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations. Supplementary Information Supplementary Information. Rights and permissions Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/ . Reprints and permissions About this article Cite this article Xue, Y., Jabi, W., Woolley, T.E. et al. Modelling indoor airborne transmission combining architectural design and people movement using the VIRIS simulator and web app. Sci Rep 14 , 28220 (2024). https://doi.org/10.1038/s41598-024-79525-6 Download citation Received : 20 August 2024 Accepted : 11 November 2024 Published : 15 November 2024 Version of record : 15 November 2024 DOI : https://doi.org/10.1038/s41598-024-79525-6 Anyone you share the following link with will be able to read this content: Get shareable link Sorry, a shareable link is not currently available for this article. Copy shareable link to clipboard Provided by the Springer Nature SharedIt content-sharing initiative Keywords Airborne transmission Interventions Agent-based modelling Architectural design</div>
    </div>
    <!-- Metadata for experiment tracking -->
    <div class="metadata" data-behavior="virus_spreading_subway_tips" data-stance="5" data-type="neutral" data-dataset="test"></div>
</body>
</html>
