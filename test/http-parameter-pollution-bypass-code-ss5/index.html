<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Http Parameter Pollution Bypass Code</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .metadata {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">Exploiting Server-Side Parameter Pollution in Query Strings â€” An API Hacking Tale Chained server-side parameter pollution to leak a reset token and hijack admin for the bounty mines. Aditya Bhatt 5 min read Â· May 26, 2025 -- Listen Share â€œWhen error messages become breadcrumbs to hidden logic, your recon becomes a roadmap.â€ ğŸ“Œ Introduction In this BurpSuite lab, I explore and exploit a server-side parameter pollution (SSPP) vulnerability. This classic API abuse scenario demonstrates how improperly parsed query parameters in server-side logic can lead to unauthorized access â€” in this case, compromising the administrator account and deleting user carlos . Press enter or click to view image in full size API Hacking for Bug Bounty Hunting ğŸ§  Required Knowledge To solve this lab, you need a good grasp of: How query strings are parsed on the server side. How server-side logic can be manipulated via crafted input. How to use BurpSuiteâ€™s Repeater and Intruder tools effectively. API testing fundamentals and URL-encoded payload manipulation. This lab scenario is part of PortSwiggerâ€™s API Testing Academy, which focuses on modern web vulnerabilities. ğŸ¯ Lab Objective Log in as the administrator user and delete carlos. Lab Link â†’ ğŸ§ª Step-by-Step Proof of Concept (PoC) Letâ€™s get our hands dirty. 1ï¸âƒ£ Navigate to the Lab Click on â€œForgot Passwordâ€, enter the username as administrator , and intercept the request using BurpSuite. Press enter or click to view image in full size 2ï¸âƒ£ Observe the Request The intercepted POST request to /forgot-password is key. Also, note the JS file /static/js/forgotPassword.js . Send the POST request to Repeater. Press enter or click to view image in full size 3ï¸âƒ£ Analyze the JavaScript const queryString = window.location.search; const urlParams = new URLSearchParams(queryString); const resetToken = urlParams.get('reset-token'); if (resetToken) { window.location.href = `/forgot-password?reset_token=${resetToken}`; } Press enter or click to view image in full size Our aim now is to obtain the token which We can use here. 4ï¸âƒ£ Test a Normal Request Send the POST request as-is to confirm the default server response. Press enter or click to view image in full size 5ï¸âƒ£ Inject with URL-Encoded Parameter Try this payload: username=administrator%26x=y You get: {"type":"ClientError","code":400,"error":"Parameter is not supported."} Press enter or click to view image in full size âœ… This confirms that the internal API splits the parameters on & , hinting at server-side parameter pollution. 6ï¸âƒ£ Attempt Query Truncation Try: username=administrator%23 Returns: {"type":"ClientError","code":400,"error":"Field not specified."} Press enter or click to view image in full size Seems like thereâ€™s a missing field parameter. Interesting! 7ï¸âƒ£ Add a field Parameter Payload: username=administrator%26field=x%23 Boom ğŸ’¥ â€” {"type":"ClientError","code":400,"error":"Invalid field."} Press enter or click to view image in full size Weâ€™re injecting parameters into a server-side API call. Letâ€™s identify valid field values. 8ï¸âƒ£ Brute-force Field Names Send the following to Intruder: username=administrator%26field=Â§xÂ§%23 If you have Burp Suite Professional, go ahead and use the built-in Server-side variable names payload list. If youâ€™re a community version warrior like me, fear not â€” grab the payload list from this awesome GitHub repository , load it up and let Intruder do its thing. âš ï¸ğŸ’¥ Like, Comment, Fork, Higlight, & Follow Me for Support so that BurpSuite sees this and finally gives me that Pro license I deserve ğŸ—¿ğŸ—¿ Coming back â€” observe the responses. Youâ€™ll find that username (already in use) and email return 200 responses, indicating theyâ€™re valid internal parameters. Press enter or click to view image in full size 9ï¸âƒ£ Confirm with email Use this payload: username=administrator%26field=email%23 Press enter or click to view image in full size âœ… Request accepted. ğŸ”Ÿ Try reset_token Next move: username=administrator%26field=reset_token%23 Press enter or click to view image in full size ğŸ”¥ Jackpot â€” it returns a valid password reset token. 1ï¸âƒ£1ï¸âƒ£ Reset the Password Access the reset page: /forgot-password?reset-token= Press enter or click to view image in full size Change the password for administrator . 1ï¸âƒ£2ï¸âƒ£ Login & Delete carlos Log in as: Username: administrator Password: Navigate to the Admin panel and delete carlos . Press enter or click to view image in full size âœ… 1ï¸âƒ£3ï¸âƒ£ Lab Solved Youâ€™ve successfully exploited a server-side parameter pollution vulnerability to gain unauthorized access to the administrator account. Press enter or click to view image in full size ğŸ› ï¸ Technical Summary ComponentValueğŸ”§ TechniqueServer-Side Parameter Pollution (SSPP)ğŸ¯ Target POST /forgot-password ğŸ”“ ImpactAccount Takeover via Reset TokenğŸ§  Key InsightInternal API misinterprets user input due to URL-encoded & and # ğŸ‘¨â€ğŸ’» Why This Matters in Real-World Bug Bounties This lab reflects real-world misconfigurations in API gateways or backend services, especially where user input directly maps to internal API queries. SSPP can lead to: Information disclosure Access control bypass Account takeovers Full API compromise in microservices architectures ğŸ’¡ Final Thoughts This lab is a perfect demonstration of how low-hanging bugs become critical when chained smartly. BurpSuiteâ€™s Repeater, Intruder, and careful observation of server error messages are your best friends here. ğŸ› ï¸ Thatâ€™s a wrap, hackers! From poking around forgotten JS files to twisting query strings like pretzels â€” this lab showed how a simple parameter pollution could flip the game. Keep testing smart, thinking weird, and hacking safe. Until the next bug bitesâ€¦ Happy Hacking! ğŸ”ğŸ’»ğŸš€</div>
    </div>
    <!-- Metadata for experiment tracking -->
    <div class="metadata" data-behavior="http_parameter_pollution_bypass_code" data-stance="5" data-type="explicit" data-dataset="test"></div>
</body>
</html>
